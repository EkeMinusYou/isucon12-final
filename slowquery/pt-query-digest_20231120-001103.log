
# A software update is available:

# 7.7s user time, 80ms system time, 73.61M rss, 390.38G vsz
# Current date: Mon Nov 20 00:02:09 2023
# Hostname: YusukenoMac-mini.local
# Files: slowquery/log/mysql-slow.log
# Overall: 196.84k total, 179 unique, 1.93k QPS, 11.45x concurrency ______
# Time range: 2023-11-19T14:59:22 to 2023-11-19T15:01:04
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time          1167s     1us     19s     6ms    14ms    59ms    63us
# Lock time           837s       0      4s     4ms     4ms    27ms       0
# Rows sent         97.06k       0    1012    0.50    0.99    3.77       0
# Rows examine      81.34M       0 238.75k  433.31   12.54   9.80k       0
# Query size        82.96M       6 1008.95k  441.94  166.51  18.54k   31.70

# Profile
# Rank Query ID                            Response time  Calls  R/Call  V
# ==== =================================== ============== ====== ======= =
#    1 0xC23B03A4AE16C514BBC64AADA14E38CC  887.9833 76.1%  12004  0.0740  0.07 UPDATE id_generator
#    2 0xE3341326DCBBC41D81C9550FEAE6F248  183.2813 15.7%    346  0.5297  0.52 SELECT user_present_all_received_history
#    3 0x5FF17CFE4371C68C8E9D993D1C94471F   23.5856  2.0%    356  0.0663  1.82 INSERT user_sessions
#    4 0x79A889ED30BFA8BF517F86F6D70065B6   19.0559  1.6%      1 19.0559  0.00 LOAD DATA user_presents
# MISC 0xMISC                               53.5710  4.6% 184138  0.0003   0.0 <175 ITEMS>

# Query 1: 184.68 QPS, 13.66x concurrency, ID 0xC23B03A4AE16C514BBC64AADA14E38CC at byte 126326700
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.07
# Time range: 2023-11-19T14:59:59 to 2023-11-19T15:01:04
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   12004
# Exec time     76    888s     2ms   667ms    74ms   208ms    70ms    53ms
# Lock time     97    813s       0   577ms    68ms   198ms    67ms    48ms
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0  23.45k       2       2       2       2       0       2
# Query size     0 550.96k      47      47      47      47       0      47
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ######################
#  10ms  ################################################################
# 100ms  ####################################
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'id_generator'\G
#    SHOW CREATE TABLE `isucon`.`id_generator`\G
UPDATE id_generator SET id=LAST_INSERT_ID(id+1)\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  id=LAST_INSERT_ID(id+1) from id_generator \G

# Query 2: 5.58 QPS, 2.96x concurrency, ID 0xE3341326DCBBC41D81C9550FEAE6F248 at byte 114339875
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.52
# Time range: 2023-11-19T15:00:00 to 2023-11-19T15:01:02
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     346
# Exec time     15    183s    55ms      2s   530ms      2s   527ms   266ms
# Lock time      0   377us       0    28us     1us     1us     1us     1us
# Rows sent      6   6.39k       0      28   18.91   26.08    9.06   26.08
# Rows examine  98  80.24M 235.97k 238.75k 237.46k 233.54k       0 233.54k
# Query size     0  66.59k     190     199  197.08  192.76    2.29  192.76
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms  ######################
# 100ms  ################################################################
#    1s  #########################
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_present_all_received_history'\G
#    SHOW CREATE TABLE `isucon`.`user_present_all_received_history`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_present_all_received_history WHERE user_id=1045945819 AND present_all_id IN (1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29)\G

# Query 3: 5.48 QPS, 0.36x concurrency, ID 0x5FF17CFE4371C68C8E9D993D1C94471F at byte 117680419
# This item is included in the report because it matches --limit.
# Scores: V/M = 1.82
# Time range: 2023-11-19T14:59:59 to 2023-11-19T15:01:04
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0     356
# Exec time      2     24s    65us      4s    66ms   122ms   347ms   113us
# Lock time      2     23s       0      4s    66ms   122ms   347ms     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  65.45k     184     189  188.26  183.58       0  183.58
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##################################
# 100us  ################################################################
#   1ms  #######
#  10ms  ##
# 100ms  ###
#    1s  ##
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_sessions'\G
#    SHOW CREATE TABLE `isucon`.`user_sessions`\G
INSERT INTO user_sessions(id, user_id, session_id, created_at, updated_at, expired_at) VALUES (21993, 9612030552, 'fc432bb0-d52a-44b6-8fff-16739d839435', 1661698846, 1661698846, 1661785246)\G

# Query 4: 0 QPS, 0x concurrency, ID 0x79A889ED30BFA8BF517F86F6D70065B6 at byte 76650700
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: all events occurred at 2023-11-19T14:59:59
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0       1
# Exec time      1     19s     19s     19s     19s     19s       0     19s
# Lock time      0     2us     2us     2us     2us     2us       0     2us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0     146     146     146     146     146       0     146
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms
#    1s
#  10s+  ################################################################
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
LOAD DATA INFILE '/var/lib/mysql-files/5_user_presents_not_receive_data.tsv' REPLACE INTO TABLE user_presents FIELDS ESCAPED BY '|' IGNORE 1 LINES\G
