
# 15.9s user time, 90ms system time, 65.25M rss, 389.99G vsz
# Current date: Wed Nov 22 04:24:18 2023
# Hostname: YusukenoMac-mini.local
# Files: slowquery/log/mysql-slow.log
# Overall: 373.49k total, 177 unique, 4.10k QPS, 5.97x concurrency _______
# Time range: 2023-11-21T19:22:07 to 2023-11-21T19:23:38
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time           543s     1us     12s     1ms     5ms    21ms   176us
# Lock time             3s       0   118ms     7us     1us   415us     1us
# Rows sent        755.91k       0    1012    2.07   13.83    6.48       0
# Rows examine       3.25M       0    1012    9.12   46.83   46.24    0.99
# Query size       115.94M       6 1008.95k  325.50  234.30  13.46k   72.65

# Profile
# Rank Query ID                            Response time Calls  R/Call  V/
# ==== =================================== ============= ====== ======= ==
#    1 0x6E790EE92EFF4755B6E0FA83F9CA8363  62.0359 11.4%   3862  0.0161  0.05 UPDATE user_presents
#    2 0x611363ACBD1690538F137757E45B738C  58.0924 10.7%   3887  0.0149  0.04 SELECT user_presents
#    3 0x03FFA53B9AEA23779E51FE7DD3DC165E  53.4972  9.8%  31169  0.0017  0.02 INSERT user_presents
#    4 0xF0F3320DE1260EAD27BC0426FCB34A4D  44.8267  8.2%   3887  0.0115  0.04 SELECT user_presents
#    5 0xE89B4FB5E77ED142BEAF8C3B369FA2FE  41.3465  7.6%   3862  0.0107  0.03 SELECT user_presents
#    6 0xED0711EB833D06BBD84F496A9784760B  25.9522  4.8%  41943  0.0006  0.01 UPDATE user_items
#    7 0x8CA5C26DA1F53D285B58FE47352DA00A  19.1172  3.5%  21218  0.0009  0.01 SELECT user_sessions
#    8 0xFFFCA4D67EA0A788813031B8BBC3B329  16.8365  3.1%  11601  0.0015  0.02 COMMIT
#    9 0x07D5CE9B533D56A3B70C17C590E82A7F  14.9600  2.8%  24827  0.0006  0.01 SELECT version_masters
#   10 0xBC551EACF5A3BE27E3F2CC3C5133F3D5  14.1804  2.6%  11485  0.0012  0.01 SELECT gacha_item_masters
#   11 0xAB2AB35C6EFA17C04018A132A84A16C9  13.0553  2.4%  23768  0.0005  0.01 SELECT user_bans
#   12 0x2372FB123B18A108CFBB5352F61B370B  12.9841  2.4%  21448  0.0006  0.01 SELECT users
#   13 0x79A889ED30BFA8BF517F86F6D70065B6  12.3817  2.3%      1 12.3817  0.00 LOAD DATA user_presents
#   14 0x584D7D428BA6602840353479CEB359A1  11.7620  2.2%  12513  0.0009  0.01 SELECT user_devices
#   15 0x2096778F723F6666B5D7DDC9D01010C7  10.4480  1.9%     46  0.2271  0.04 INSERT user_cards
#   16 0x0B3509236B570F5C5FE423B079765901   8.7130  1.6%  15014  0.0006  0.00 INSERT user_cards
#   17 0x975F0A7CC9BCA46BBC7DAD888BA0794F   8.4691  1.6%  13590  0.0006  0.01 SELECT item_masters
#   18 0x1049606E13674A053E0CC69500F839DC   7.8441  1.4%   3818  0.0021  0.01 UPDATE user_one_time_tokens
#   19 0xE63C5805E48DA98A0AD3A20E4E0B9976   7.4274  1.4%   8931  0.0008  0.01 SELECT user_login_bonuses
#   20 0xAFB4A7475DFDCF1D0D23CC5EC1952C3A   7.0278  1.3%   3839  0.0018  0.01 INSERT user_one_time_tokens
# MISC 0xMISC                              92.4136 17.0% 112785  0.0008   0.0 <157 ITEMS>

# Query 1: 63.31 QPS, 1.02x concurrency, ID 0x6E790EE92EFF4755B6E0FA83F9CA8363 at byte 136478796
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.05
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3862
# Exec time     11     62s   107us   244ms    16ms    71ms    27ms     4ms
# Lock time      0    16ms       0     4ms     4us     1us    66us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   2  95.21k       1      70   25.24   46.83   11.74   26.08
# Query size     1   1.43M      93     970  388.66  652.75  145.86  381.65
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ###########################
#   1ms  ################################################################
#  10ms  ############################################
# 100ms  ###
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
UPDATE user_presents SET deleted_at=1661714588, updated_at=1661714588 WHERE id IN (72722998, 166079414, 446165597, 690272147, 756113276, 1053406748, 1414704470, 1534678639, 1544566561, 1695452363, 1740890515, 1928060637, 2048805774, 2197630068, 2253107633, 2822070435, 2854320960, 2910332231, 2935062714, 3086738428, 3121390991, 3299231395, 3381612101, 3693103216, 3935645350, 4169720170, 4280950002, 11428281860, 28844524624, 38783994133, 42730291424, 43309433962, 43614387472, 44536133262, 45456209024, 54510299957, 54901494446, 63124435051, 69598519031, 71572960748, 74534726336, 76911930988, 77410896056, 84265473492, 88841006805, 98770004768)\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  deleted_at=1661714588, updated_at=1661714588 from user_presents where  id IN (72722998, 166079414, 446165597, 690272147, 756113276, 1053406748, 1414704470, 1534678639, 1544566561, 1695452363, 1740890515, 1928060637, 2048805774, 2197630068, 2253107633, 2822070435, 2854320960, 2910332231, 2935062714, 3086738428, 3121390991, 3299231395, 3381612101, 3693103216, 3935645350, 4169720170, 4280950002, 11428281860, 28844524624, 38783994133, 42730291424, 43309433962, 43614387472, 44536133262, 45456209024, 54510299957, 54901494446, 63124435051, 69598519031, 71572960748, 74534726336, 76911930988, 77410896056, 84265473492, 88841006805, 98770004768)\G

# Query 2: 64.78 QPS, 0.97x concurrency, ID 0x611363ACBD1690538F137757E45B738C at byte 152023613
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:37
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3887
# Exec time     10     58s   208us   219ms    15ms    68ms    24ms     5ms
# Lock time      0    24ms       0     6ms     6us     1us   114us     1us
# Rows sent     12  95.75k       0      70   25.22   46.83   11.76   26.08
# Rows examine  26 877.63k      27     756  231.20  685.39  232.58   54.21
# Query size     0 489.01k     126     129  128.83  124.25       0  124.25
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ###############################
#   1ms  ################################################################
#  10ms  ################################################
# 100ms  ###
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_presents 
	WHERE user_id = 2788033210 AND deleted_at IS NULL
	ORDER BY created_at DESC, id
	LIMIT 100 OFFSET 0\G

# Query 3: 510.97 QPS, 0.88x concurrency, ID 0x03FFA53B9AEA23779E51FE7DD3DC165E at byte 167824252
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          8   31169
# Exec time      9     53s    46us   131ms     2ms     7ms     6ms   152us
# Lock time      5   156ms       0    12ms     4us     1us   133us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     9  11.16M     234   3.32k  375.57   1.69k  576.63  234.30
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ###############################
# 100us  ################################################################
#   1ms  ###################
#  10ms  ####
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
INSERT INTO user_presents(id, user_id, sent_at, item_type, item_id, amount, present_message, created_at, updated_at) VALUES (2184355020, 3301682732, 1661714603, 1, 1, 3000, 'リリース記念プレゼントです！', 1661714603, 1661714603),(2547828443, 3301682732, 1661714603, 1, 1, 1000, '１ヶ月突破プレゼントです！', 1661714603, 1661714603),(3613610291, 3301682732, 1661714603, 1, 1, 1000, '２ヶ月突破プレゼントです！', 1661714603, 1661714603),(2626440208, 3301682732, 1661714603, 1, 1, 2000, '３ヶ月突破プレゼントです！', 1661714603, 1661714603),(587656284, 3301682732, 1661714603, 1, 1, 2000, '４ヶ月突破プレゼントです！', 1661714603, 1661714603),(1459524304, 3301682732, 1661714603, 1, 1, 2000, '５ヶ月突破プレゼントです！', 1661714603, 1661714603),(3619513498, 3301682732, 1661714603, 1, 1, 3000, 'ハーフアニバーサリープレゼントです！', 1661714603, 1661714603),(111680452, 3301682732, 1661714603, 1, 1, 2000, '７ヶ月突破プレゼントです！', 1661714603, 1661714603),(2696798120, 3301682732, 1661714603, 1, 1, 2000, '８ヶ月突破プレゼントです！', 1661714603, 1661714603),(3186797400, 3301682732, 1661714603, 1, 1, 2000, '９ヶ月突破プレゼントです！', 1661714603, 1661714603),(1632962041, 3301682732, 1661714603, 1, 1, 2000, '１０ヶ月突破プレゼントです！', 1661714603, 1661714603),(980478606, 3301682732, 1661714603, 1, 1, 2000, '１１ヶ月突破プレゼントです！', 1661714603, 1661714603),(1034094129, 3301682732, 1661714603, 1, 1, 3000, '１周年突破プレゼントです！', 1661714603, 1661714603),(3608945836, 3301682732, 1661714603, 1, 1, 6000, '周年記念プレゼントです！', 1661714603, 1661714603),(1690588487, 3301682732, 1661714603, 1, 1, 2000, '１３ヶ月突破プレゼントです！', 1661714603, 1661714603),(3427260692, 3301682732, 1661714603, 1, 1, 2000, '１４ヶ月突破プレゼントです！', 1661714603, 1661714603),(393804612, 3301682732, 1661714603, 1, 1, 2000, '１５ヶ月突破プレゼントです１', 1661714603, 1661714603),(1058972783, 3301682732, 1661714603, 1, 1, 2000, '１６ヶ月突破プレゼントです！', 1661714603, 1661714603),(156280088, 3301682732, 1661714603, 1, 1, 2000, '１７ヶ月突破プレゼントです！', 1661714603, 1661714603),(3015040807, 3301682732, 1661714603, 1, 1, 2000, '１８ヶ月突破プレゼントです！', 1661714603, 1661714603),(1550032943, 3301682732, 1661714603, 1, 1, 2000, '１９ヶ月突破プレゼントです！', 1661714603, 1661714603),(3171688299, 3301682732, 1661714603, 1, 1, 2000, '２０ヶ月突破プレゼントです！', 1661714603, 1661714603),(293245499, 3301682732, 1661714603, 1, 1, 2000, '２１ヶ月プレゼントです！', 1661714603, 1661714603),(2143023867, 3301682732, 1661714603, 1, 1, 2000, '２２ヶ月プレゼントです！', 1661714603, 1661714603),(2763341305, 3301682732, 1661714603, 1, 1, 2000, '２３ヶ月プレゼントです！', 1661714603, 1661714603),(1372984117, 3301682732, 1661714603, 1, 1, 6000, '２周年記念プレゼントです！', 1661714603, 1661714603),(330240180, 3301682732, 1661714603, 1, 1, 6000, '２.５周年プレゼントです！', 1661714603, 1661714603),(3188288100, 3301682732, 1661714603, 1, 1, 6000, 'CM放映記念プレゼントです！', 1661714603, 1661714603)\G

# Query 4: 64.78 QPS, 0.75x concurrency, ID 0xF0F3320DE1260EAD27BC0426FCB34A4D at byte 136413898
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:37
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3887
# Exec time      8     45s   169us   278ms    12ms    53ms    22ms     3ms
# Lock time      0    24ms       0     5ms     6us     1us    96us     1us
# Rows sent      0   3.80k       1       1       1       1       0       1
# Rows examine  23 781.88k      27     723  205.98  652.75  225.73   36.69
# Query size     0 318.20k      81      84   83.83   80.10       0   80.10
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  #################################################
#   1ms  ################################################################
#  10ms  #######################################
# 100ms  ##
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT COUNT(*) FROM user_presents WHERE user_id = 6326545130 AND deleted_at IS NULL\G

# Query 5: 63.31 QPS, 0.68x concurrency, ID 0xE89B4FB5E77ED142BEAF8C3B369FA2FE at byte 138580853
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.03
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3862
# Exec time      7     41s   126us   190ms    11ms    51ms    19ms     1ms
# Lock time      1    44ms       0    26ms    11us     1us   415us     1us
# Rows sent     12  95.21k       1      70   25.24   46.83   11.74   26.08
# Rows examine   2  95.21k       1      70   25.24   46.83   11.74   26.08
# Query size     1   1.36M      74     951  369.66  621.67  145.90  363.48
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##########################################
#  10ms  ########################################
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_presents WHERE id IN (133723426, 611924738, 645287466, 758809484, 835725301, 890088946, 1085518344, 1179890849, 1183072850, 1237480913, 1472541659, 1812395428, 1974822042, 2067500932, 2074819005, 2192542351, 2705608214, 2931911595, 3340527734, 3409937358, 3708256910, 3778536975, 3799610277, 3935418130, 4162830449, 4214602111, 4249833999, 4259592851) AND deleted_at IS NULL\G

# Query 6: 687.59 QPS, 0.43x concurrency, ID 0xED0711EB833D06BBD84F496A9784760B at byte 167739300
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         11   41943
# Exec time      4     26s    52us    82ms   618us     2ms     2ms   131us
# Lock time      7   195ms       0    21ms     4us     1us   141us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   1  40.96k       1       1       1       1       0       1
# Query size     2   3.00M      70      76   74.90   72.65    0.47   72.65
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #############################
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_items'\G
#    SHOW CREATE TABLE `isucon`.`user_items`\G
UPDATE user_items SET amount=99, updated_at=1661714603 WHERE id=90529029873\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  amount=99, updated_at=1661714603 from user_items where  id=90529029873\G

# Query 7: 347.84 QPS, 0.31x concurrency, ID 0x8CA5C26DA1F53D285B58FE47352DA00A at byte 142611787
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5   21218
# Exec time      3     19s    93us    78ms   900us     4ms     3ms   214us
# Lock time      5   140ms       0    23ms     6us     1us   203us     1us
# Rows sent      2  20.72k       0       1    1.00    0.99    0.01    0.99
# Rows examine   0  20.72k       0       1    1.00    0.99    0.01    0.99
# Query size     1   2.14M      81     106  106.00  102.22    0.15  102.22
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ###########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_sessions'\G
#    SHOW CREATE TABLE `isucon`.`user_sessions`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_sessions WHERE session_id='8309517d-c5ad-421e-927a-5ecc61cdb153' AND deleted_at IS NULL\G

# Query 8: 190.18 QPS, 0.28x concurrency, ID 0xFFFCA4D67EA0A788813031B8BBC3B329 at byte 156389986
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   11601
# Exec time      3     17s    37us   122ms     1ms     6ms     5ms   260us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  67.97k       6       6       6       6       0       6
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ###########################################
# 100us  ################################################################
#   1ms  ##########################
#  10ms  ####
# 100ms  #
#    1s
#  10s+
COMMIT\G

# Query 9: 413.78 QPS, 0.25x concurrency, ID 0x07D5CE9B533D56A3B70C17C590E82A7F at byte 92805266
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:37
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   24827
# Exec time      2     15s    53us   122ms   602us     2ms     3ms   138us
# Lock time      7   212ms       0    29ms     8us     1us   281us     1us
# Rows sent      3  24.25k       1       1       1       1       0       1
# Rows examine   1  41.24k       1       2    1.70    1.96    0.45    1.96
# Query size     0   1.04M      44      44      44      44       0      44
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ########################
# 100us  ################################################################
#   1ms  #########
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'version_masters'\G
#    SHOW CREATE TABLE `isucon`.`version_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM version_masters WHERE status=1\G

# Query 10: 188.28 QPS, 0.23x concurrency, ID 0xBC551EACF5A3BE27E3F2CC3C5133F3D5 at byte 195394214
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   11485
# Exec time      2     14s   119us    52ms     1ms     5ms     3ms   348us
# Lock time      3   105ms       0    13ms     9us     1us   206us     1us
# Rows sent     42 319.64k      27      29   28.50   28.75       1   28.75
# Rows examine  19 639.29k      54      58   57.00   56.92       2   56.92
# Query size     0 745.83k      66      68   66.50   65.89       0   65.89
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'gacha_item_masters'\G
#    SHOW CREATE TABLE `isucon`.`gacha_item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM gacha_item_masters WHERE gacha_id=37 ORDER BY id ASC\G

# Query 11: 396.13 QPS, 0.22x concurrency, ID 0xAB2AB35C6EFA17C04018A132A84A16C9 at byte 168137537
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:37
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   23768
# Exec time      2     13s    42us    61ms   549us     2ms     2ms   125us
# Lock time      3   107ms       0     5ms     4us     1us    77us     1us
# Rows sent      0     595       0       1    0.03       0    0.15       0
# Rows examine   0     595       0       1    0.03       0    0.15       0
# Query size     0   1.08M      45      48   47.84   46.83    0.28   46.83
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #########################################
# 100us  ################################################################
#   1ms  ###########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_bans'\G
#    SHOW CREATE TABLE `isucon`.`user_bans`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_bans WHERE user_id=245349080\G

# Query 12: 351.61 QPS, 0.21x concurrency, ID 0x2372FB123B18A108CFBB5352F61B370B at byte 167740650
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5   21448
# Exec time      2     13s    50us    69ms   605us     2ms     2ms   138us
# Lock time      4   126ms       0    33ms     5us     1us   230us     1us
# Rows sent      2  20.94k       0       1    1.00    0.99    0.01    0.99
# Rows examine   0  20.94k       0       1    1.00    0.99    0.01    0.99
# Query size     0 813.46k      33      39   38.84   38.53    0.66   38.53
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##############################
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'users'\G
#    SHOW CREATE TABLE `isucon`.`users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM users WHERE id=1529828095\G

# Query 13: 0 QPS, 0x concurrency, ID 0x79A889ED30BFA8BF517F86F6D70065B6 at byte 76650857
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: all events occurred at 2023-11-21T19:22:37
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0       1
# Exec time      2     12s     12s     12s     12s     12s       0     12s
# Lock time      0     2us     2us     2us     2us     2us       0     2us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0     146     146     146     146     146       0     146
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms
#    1s
#  10s+  ################################################################
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
LOAD DATA INFILE '/var/lib/mysql-files/5_user_presents_not_receive_data.tsv' REPLACE INTO TABLE user_presents FIELDS ESCAPED BY '|' IGNORE 1 LINES\G

# Query 14: 205.13 QPS, 0.19x concurrency, ID 0x584D7D428BA6602840353479CEB359A1 at byte 193459477
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   12513
# Exec time      2     12s   101us    55ms   939us     4ms     2ms   224us
# Lock time      2    77ms       0     9ms     6us     1us   122us     1us
# Rows sent      1  12.22k       1       1       1       1       0       1
# Rows examine   0  12.22k       1       1       1       1       0       1
# Query size     0 943.78k      74      78   77.23   76.28    1.18   76.28
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_devices'\G
#    SHOW CREATE TABLE `isucon`.`user_devices`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_devices WHERE user_id=2975235131 AND platform_id='25696791'\G

# Query 15: 4.60 QPS, 1.04x concurrency, ID 0x2096778F723F6666B5D7DDC9D01010C7 at byte 19827863
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2023-11-21T19:22:08 to 2023-11-21T19:22:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0      46
# Exec time      1     10s   146ms   520ms   227ms   412ms    96ms   180ms
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size    38  45.18M 970.86k 1006.59k 1005.76k 961.27k       0 961.27k
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms  ################################################################
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_cards'\G
#    SHOW CREATE TABLE `isucon`.`user_cards`\G
INSERT INTO `user_cards` VALUES (41495665151,3703247521,3,76,38,7696,1571593513,1571593513,NULL) /*... omitted ...*/\G

# Query 16: 246.13 QPS, 0.14x concurrency, ID 0x0B3509236B570F5C5FE423B079765901 at byte 119685082
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          4   15014
# Exec time      1      9s    51us    38ms   580us     2ms     2ms   131us
# Lock time      1    44ms       0     3ms     2us     1us    46us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     2   2.44M     165     176  170.22  166.51    0.91  166.51
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #######################
# 100us  ################################################################
#   1ms  ##########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_cards'\G
#    SHOW CREATE TABLE `isucon`.`user_cards`\G
INSERT INTO user_cards(id, user_id, card_id, amount_per_sec, level, total_exp, created_at, updated_at) VALUES (3500610098, 2741620086, 11, 500, 1, 0, 1661714581, 1661714581)\G

# Query 17: 222.79 QPS, 0.14x concurrency, ID 0x975F0A7CC9BCA46BBC7DAD888BA0794F at byte 124976311
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   13590
# Exec time      1      8s    56us    47ms   623us     2ms     2ms   152us
# Lock time      2    67ms       0    15ms     4us     1us   161us     1us
# Rows sent      1  13.27k       1       1       1       1       0       1
# Rows examine   0  13.27k       1       1       1       1       0       1
# Query size     0 706.32k      53      54   53.22   51.63       0   51.63
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ########################
# 100us  ################################################################
#   1ms  ###########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'item_masters'\G
#    SHOW CREATE TABLE `isucon`.`item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM item_masters WHERE id=3 AND item_type=2\G

# Query 18: 63.63 QPS, 0.13x concurrency, ID 0x1049606E13674A053E0CC69500F839DC at byte 159811611
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:37
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3818
# Exec time      1      8s   136us    97ms     2ms     9ms     5ms   403us
# Lock time      1    32ms       0     7ms     8us     1us   145us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0   3.73k       1       1       1       1       0       1
# Query size     0 387.77k     104     104     104     104       0     104
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #########################
#  10ms  ###
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_one_time_tokens'\G
#    SHOW CREATE TABLE `isucon`.`user_one_time_tokens`\G
UPDATE user_one_time_tokens SET deleted_at=1661714600 WHERE token='711e2053-032a-4ee7-abab-26ef90b612de'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  deleted_at=1661714600 from user_one_time_tokens where  token='711e2053-032a-4ee7-abab-26ef90b612de'\G

# Query 19: 146.41 QPS, 0.12x concurrency, ID 0xE63C5805E48DA98A0AD3A20E4E0B9976 at byte 124932973
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          2    8931
# Exec time      1      7s    79us    89ms   831us     3ms     3ms   185us
# Lock time      1    51ms       0    13ms     5us     1us   180us     1us
# Rows sent      0   5.73k       0       1    0.66    0.99    0.47    0.99
# Rows examine   0   5.73k       0       1    0.66    0.99    0.47    0.99
# Query size     0 678.93k      75      78   77.84   76.28    0.46   76.28
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_login_bonuses'\G
#    SHOW CREATE TABLE `isucon`.`user_login_bonuses`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_login_bonuses WHERE user_id=908467693 AND login_bonus_id=2\G

# Query 20: 62.93 QPS, 0.12x concurrency, ID 0xAFB4A7475DFDCF1D0D23CC5EC1952C3A at byte 156380015
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:22:37 to 2023-11-21T19:23:38
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3839
# Exec time      1      7s   100us   121ms     2ms     8ms     5ms   403us
# Lock time      0    21ms       0    12ms     5us     1us   190us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0 789.45k     206     211  210.58  202.40       0  202.40
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ######################
#  10ms  ###
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_one_time_tokens'\G
#    SHOW CREATE TABLE `isucon`.`user_one_time_tokens`\G
INSERT INTO user_one_time_tokens(id, user_id, token, token_type, created_at, updated_at, expired_at) VALUES (3085928532, 4126362550, '9033dcce-54fa-4083-875b-3e35a7af319c', 2, 1661714598, 1661714598, 1661715198)\G
