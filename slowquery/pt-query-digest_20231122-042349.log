
# 14.4s user time, 90ms system time, 57.91M rss, 390.02G vsz
# Current date: Wed Nov 22 04:11:41 2023
# Hostname: YusukenoMac-mini.local
# Files: slowquery/log/mysql-slow.log
# Overall: 328.98k total, 177 unique, 3.62k QPS, 7.34x concurrency _______
# Time range: 2023-11-21T19:09:19 to 2023-11-21T19:10:50
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time           668s     1us     11s     2ms     8ms    21ms   176us
# Lock time             2s       0    99ms     6us     1us   356us     1us
# Rows sent        664.69k       0    1012    2.07   13.83    6.49       0
# Rows examine      26.06M       0   2.56k   83.07  463.90  345.26    0.99
# Query size       110.58M       6 1008.95k  352.45  234.30  14.35k   72.65

# Profile
# Rank Query ID                            Response time  Calls  R/Call  V
# ==== =================================== ============== ====== ======= =
#    1 0x8CA5C26DA1F53D285B58FE47352DA00A  139.7013 20.9%  18645  0.0075  0.02 SELECT user_sessions
#    2 0x6E790EE92EFF4755B6E0FA83F9CA8363   64.0545  9.6%   3385  0.0189  0.05 UPDATE user_presents
#    3 0x611363ACBD1690538F137757E45B738C   56.5981  8.5%   3402  0.0166  0.04 SELECT user_presents
#    4 0x03FFA53B9AEA23779E51FE7DD3DC165E   45.1126  6.8%  27512  0.0016  0.03 INSERT user_presents
#    5 0xF0F3320DE1260EAD27BC0426FCB34A4D   41.8481  6.3%   3402  0.0123  0.04 SELECT user_presents
#    6 0xE89B4FB5E77ED142BEAF8C3B369FA2FE   39.2628  5.9%   3385  0.0116  0.04 SELECT user_presents
#    7 0x975F0A7CC9BCA46BBC7DAD888BA0794F   38.8699  5.8%  12034  0.0032  0.03 SELECT item_masters
#    8 0xED0711EB833D06BBD84F496A9784760B   21.1249  3.2%  37491  0.0006  0.01 UPDATE user_items
#    9 0x07D5CE9B533D56A3B70C17C590E82A7F   14.0485  2.1%  21890  0.0006  0.01 SELECT version_masters
#   10 0xFFFCA4D67EA0A788813031B8BBC3B329   13.3426  2.0%  10158  0.0013  0.01 COMMIT
#   11 0xBC551EACF5A3BE27E3F2CC3C5133F3D5   12.8898  1.9%  10159  0.0013  0.01 SELECT gacha_item_masters
#   12 0x2372FB123B18A108CFBB5352F61B370B   12.4749  1.9%  18945  0.0007  0.01 SELECT users
#   13 0xAB2AB35C6EFA17C04018A132A84A16C9   11.7350  1.8%  20996  0.0006  0.01 SELECT user_bans
#   14 0x584D7D428BA6602840353479CEB359A1   11.6388  1.7%  11038  0.0011  0.01 SELECT user_devices
#   15 0x79A889ED30BFA8BF517F86F6D70065B6   11.2038  1.7%      1 11.2038  0.00 LOAD DATA user_presents
#   16 0x2096778F723F6666B5D7DDC9D01010C7   10.9714  1.6%     46  0.2385  0.05 INSERT user_cards
#   17 0x1049606E13674A053E0CC69500F839DC    7.6559  1.1%   3337  0.0023  0.02 UPDATE user_one_time_tokens
#   18 0xAFB4A7475DFDCF1D0D23CC5EC1952C3A    6.9963  1.0%   3366  0.0021  0.02 INSERT user_one_time_tokens
#   19 0x0B3509236B570F5C5FE423B079765901    6.7555  1.0%  13156  0.0005  0.01 INSERT user_cards
#   20 0x9A8F7951E72A024B1DB911A4707B09DB    6.6034  1.0%   2532  0.0026  0.03 SELECT item_masters
# MISC 0xMISC                               95.3583 14.3% 104100  0.0009   0.0 <157 ITEMS>

# Query 1: 310.75 QPS, 2.33x concurrency, ID 0x8CA5C26DA1F53D285B58FE47352DA00A at byte 145561803
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5   18645
# Exec time     20    140s    89us   158ms     7ms    36ms    13ms     2ms
# Lock time      4   100ms       0     8ms     5us     1us   115us     1us
# Rows sent      2  18.21k       0       1    1.00    0.99    0.01    0.99
# Rows examine  88  23.16M       4   2.56k   1.27k   2.38k  748.36   1.26k
# Query size     1   1.88M      81     106  106.00  102.22    0.16  102.22
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ##############################################
#   1ms  ################################################################
#  10ms  #############################
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_sessions'\G
#    SHOW CREATE TABLE `isucon`.`user_sessions`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_sessions WHERE session_id='5f272529-8a5f-4cce-aad6-5975ef627c36' AND deleted_at IS NULL\G

# Query 2: 56.42 QPS, 1.07x concurrency, ID 0x6E790EE92EFF4755B6E0FA83F9CA8363 at byte 149304691
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.05
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3385
# Exec time      9     64s   109us   268ms    19ms    87ms    31ms     5ms
# Lock time      0    16ms       0     5ms     4us     1us    86us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0  83.09k       1      70   25.13   46.83   11.59   26.08
# Query size     1   1.25M      93     968  387.71  652.75  144.36  381.65
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ##########################
#   1ms  ################################################################
#  10ms  ##################################################
# 100ms  ######
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
UPDATE user_presents SET deleted_at=1661713830, updated_at=1661713830 WHERE id IN (30014458, 65609487, 218459161, 219086003, 351623104, 449970134, 923081591, 1107446743, 1241626787, 1280460345, 1486064211, 1644308823, 1774122599, 2017273953, 2020172169, 2254314778, 2339959243, 2397750515, 2526558711, 2863572696, 2875387696, 3189988057, 3223180591, 3245835763, 3713211416, 3906275192, 4044282879, 4749896387, 9469641230, 10391285319, 13056251967, 15235464456, 18826755445, 19940596866, 20770713957, 23494742656, 26960717954, 32253584712, 33593132157, 45755442021, 48972357611, 52725599877, 61109997021, 80524466583, 81079145454, 88544702323, 89730838245, 96099642118)\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  deleted_at=1661713830, updated_at=1661713830 from user_presents where  id IN (30014458, 65609487, 218459161, 219086003, 351623104, 449970134, 923081591, 1107446743, 1241626787, 1280460345, 1486064211, 1644308823, 1774122599, 2017273953, 2020172169, 2254314778, 2339959243, 2397750515, 2526558711, 2863572696, 2875387696, 3189988057, 3223180591, 3245835763, 3713211416, 3906275192, 4044282879, 4749896387, 9469641230, 10391285319, 13056251967, 15235464456, 18826755445, 19940596866, 20770713957, 23494742656, 26960717954, 32253584712, 33593132157, 45755442021, 48972357611, 52725599877, 61109997021, 80524466583, 81079145454, 88544702323, 89730838245, 96099642118)\G

# Query 3: 56.70 QPS, 0.94x concurrency, ID 0x611363ACBD1690538F137757E45B738C at byte 130400255
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3402
# Exec time      8     57s   218us   205ms    17ms    75ms    27ms     5ms
# Lock time      0    20ms       0     6ms     5us     1us   112us     1us
# Rows sent     12  83.48k       0      70   25.13   46.83   11.59   26.08
# Rows examine   3 801.96k      27     744  241.39  685.39  238.34  124.25
# Query size     0 428.02k     126     129  128.83  124.25       0  124.25
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ############################
#   1ms  ################################################################
#  10ms  #################################################
# 100ms  ####
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_presents 
	WHERE user_id = 9531998156 AND deleted_at IS NULL
	ORDER BY created_at DESC, id
	LIMIT 100 OFFSET 0\G

# Query 4: 458.53 QPS, 0.75x concurrency, ID 0x03FFA53B9AEA23779E51FE7DD3DC165E at byte 130194856
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.03
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          8   27512
# Exec time      6     45s    45us   175ms     2ms     6ms     6ms   138us
# Lock time      5   127ms       0    12ms     4us     1us   111us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     8   9.73M     235   3.32k  370.83   1.69k  566.06  234.30
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #################################
# 100us  ################################################################
#   1ms  #################
#  10ms  ####
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
INSERT INTO user_presents(id, user_id, sent_at, item_type, item_id, amount, present_message, created_at, updated_at) VALUES (3983353580, 4200837874, 1661713820, 1, 1, 3000, 'リリース記念プレゼントです！', 1661713820, 1661713820),(4169406943, 4200837874, 1661713820, 1, 1, 1000, '１ヶ月突破プレゼントです！', 1661713820, 1661713820),(3496526001, 4200837874, 1661713820, 1, 1, 1000, '２ヶ月突破プレゼントです！', 1661713820, 1661713820),(1956259835, 4200837874, 1661713820, 1, 1, 2000, '３ヶ月突破プレゼントです！', 1661713820, 1661713820),(1248258120, 4200837874, 1661713820, 1, 1, 2000, '４ヶ月突破プレゼントです！', 1661713820, 1661713820),(813876166, 4200837874, 1661713820, 1, 1, 2000, '５ヶ月突破プレゼントです！', 1661713820, 1661713820),(2516396708, 4200837874, 1661713820, 1, 1, 3000, 'ハーフアニバーサリープレゼントです！', 1661713820, 1661713820),(1150719929, 4200837874, 1661713820, 1, 1, 2000, '７ヶ月突破プレゼントです！', 1661713820, 1661713820),(4073150127, 4200837874, 1661713820, 1, 1, 2000, '８ヶ月突破プレゼントです！', 1661713820, 1661713820),(494921723, 4200837874, 1661713820, 1, 1, 2000, '９ヶ月突破プレゼントです！', 1661713820, 1661713820),(1439297672, 4200837874, 1661713820, 1, 1, 2000, '１０ヶ月突破プレゼントです！', 1661713820, 1661713820),(3366784930, 4200837874, 1661713820, 1, 1, 2000, '１１ヶ月突破プレゼントです！', 1661713820, 1661713820),(237245028, 4200837874, 1661713820, 1, 1, 3000, '１周年突破プレゼントです！', 1661713820, 1661713820),(2617217213, 4200837874, 1661713820, 1, 1, 6000, '周年記念プレゼントです！', 1661713820, 1661713820),(1706925088, 4200837874, 1661713820, 1, 1, 2000, '１３ヶ月突破プレゼントです！', 1661713820, 1661713820),(4101472984, 4200837874, 1661713820, 1, 1, 2000, '１４ヶ月突破プレゼントです！', 1661713820, 1661713820),(2796789992, 4200837874, 1661713820, 1, 1, 2000, '１５ヶ月突破プレゼントです１', 1661713820, 1661713820),(2403990095, 4200837874, 1661713820, 1, 1, 2000, '１６ヶ月突破プレゼントです！', 1661713820, 1661713820),(4146849035, 4200837874, 1661713820, 1, 1, 2000, '１７ヶ月突破プレゼントです！', 1661713820, 1661713820),(3288741920, 4200837874, 1661713820, 1, 1, 2000, '１８ヶ月突破プレゼントです！', 1661713820, 1661713820),(3700954426, 4200837874, 1661713820, 1, 1, 2000, '１９ヶ月突破プレゼントです！', 1661713820, 1661713820),(1935940682, 4200837874, 1661713820, 1, 1, 2000, '２０ヶ月突破プレゼントです！', 1661713820, 1661713820),(2098304345, 4200837874, 1661713820, 1, 1, 2000, '２１ヶ月プレゼントです！', 1661713820, 1661713820),(860589484, 4200837874, 1661713820, 1, 1, 2000, '２２ヶ月プレゼントです！', 1661713820, 1661713820),(3340341518, 4200837874, 1661713820, 1, 1, 2000, '２３ヶ月プレゼントです！', 1661713820, 1661713820),(2719311753, 4200837874, 1661713820, 1, 1, 6000, '２周年記念プレゼントです！', 1661713820, 1661713820),(2706142747, 4200837874, 1661713820, 1, 1, 6000, '２.５周年プレゼントです！', 1661713820, 1661713820),(3924206695, 4200837874, 1661713820, 1, 1, 6000, 'CM放映記念プレゼントです！', 1661713820, 1661713820)\G

# Query 5: 56.70 QPS, 0.70x concurrency, ID 0xF0F3320DE1260EAD27BC0426FCB34A4D at byte 164156771
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3402
# Exec time      6     42s   191us   217ms    12ms    61ms    22ms     3ms
# Lock time      0    17ms       0     2ms     4us     1us    60us     1us
# Rows sent      0   3.32k       1       1       1       1       0       1
# Rows examine   2 718.49k      27     712  216.26  652.75  231.78  112.70
# Query size     0 278.51k      81      84   83.83   80.10       0   80.10
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ######################################################
#   1ms  ################################################################
#  10ms  ###########################################
# 100ms  ##
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT COUNT(*) FROM user_presents WHERE user_id = 3641516240 AND deleted_at IS NULL\G

# Query 6: 56.42 QPS, 0.65x concurrency, ID 0xE89B4FB5E77ED142BEAF8C3B369FA2FE at byte 149305562
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.04
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3385
# Exec time      5     39s   102us   252ms    12ms    59ms    22ms     1ms
# Lock time      0    14ms       0     4ms     4us     1us    73us     1us
# Rows sent     12  83.09k       1      70   25.13   46.83   11.59   26.08
# Rows examine   0  83.09k       1      70   25.13   46.83   11.59   26.08
# Query size     1   1.19M      74     949  368.71  621.67  144.15  363.48
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##########################################
#  10ms  #####################################
# 100ms  ##
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_presents WHERE id IN (3725185855, 409290812, 919733824, 975359696, 1135608998, 1169973684, 1312370515, 1689343405, 2379037518, 3452397354, 3846417505, 96783177851, 72264656445, 75105916580, 4168085350, 63462727647, 58201706652, 52693553634, 95137151997, 45236498744, 6929362915, 20830298888, 28943301726) AND deleted_at IS NULL\G

# Query 7: 200.57 QPS, 0.65x concurrency, ID 0x975F0A7CC9BCA46BBC7DAD888BA0794F at byte 167367414
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.03
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   12034
# Exec time      5     39s    61us   158ms     3ms    18ms    10ms   176us
# Lock time      3    87ms       0    46ms     7us     1us   421us     1us
# Rows sent      1  11.75k       1       1       1       1       0       1
# Rows examine   0  11.75k       1       1       1       1       0       1
# Query size     0 625.38k      53      54   53.22   51.63       0   51.63
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #######################
# 100us  ################################################################
#   1ms  #################
#  10ms  #########
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'item_masters'\G
#    SHOW CREATE TABLE `isucon`.`item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM item_masters WHERE id=2 AND item_type=2\G

# Query 8: 624.85 QPS, 0.35x concurrency, ID 0xED0711EB833D06BBD84F496A9784760B at byte 145404241
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         11   37491
# Exec time      3     21s    54us   101ms   563us     2ms     2ms   119us
# Lock time      6   152ms       0    16ms     4us     1us   113us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0  36.61k       1       1       1       1       0       1
# Query size     2   2.68M      69      76   74.92   72.65    0.46   72.65
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##################################
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_items'\G
#    SHOW CREATE TABLE `isucon`.`user_items`\G
UPDATE user_items SET amount=106, updated_at=1661713828 WHERE id=58029224197\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  amount=106, updated_at=1661713828 from user_items where  id=58029224197\G

# Query 9: 364.83 QPS, 0.23x concurrency, ID 0x07D5CE9B533D56A3B70C17C590E82A7F at byte 91987262
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   21890
# Exec time      2     14s    47us   132ms   641us     2ms     3ms   138us
# Lock time      6   157ms       0    22ms     7us     1us   225us     1us
# Rows sent      3  21.38k       1       1       1       1       0       1
# Rows examine   0  35.95k       1       2    1.68    1.96    0.45    1.96
# Query size     0 940.59k      44      44      44      44       0      44
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##########################
# 100us  ################################################################
#   1ms  ##########
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'version_masters'\G
#    SHOW CREATE TABLE `isucon`.`version_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM version_masters WHERE status=1\G

# Query 10: 169.30 QPS, 0.22x concurrency, ID 0xFFFCA4D67EA0A788813031B8BBC3B329 at byte 137474559
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   10158
# Exec time      1     13s    34us   104ms     1ms     6ms     4ms   224us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  59.52k       6       6       6       6       0       6
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ###############################################
# 100us  ################################################################
#   1ms  #######################
#  10ms  ####
# 100ms  #
#    1s
#  10s+
COMMIT\G

# Query 11: 169.32 QPS, 0.21x concurrency, ID 0xBC551EACF5A3BE27E3F2CC3C5133F3D5 at byte 170380345
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   10159
# Exec time      1     13s   116us    62ms     1ms     5ms     3ms   332us
# Lock time      3    84ms       0    15ms     8us     1us   223us     1us
# Rows sent     42 282.74k      27      29   28.50   28.75       1   28.75
# Rows examine   2 565.47k      54      58   57.00   56.92       2   56.92
# Query size     0 659.71k      66      68   66.50   65.89       0   65.89
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'gacha_item_masters'\G
#    SHOW CREATE TABLE `isucon`.`gacha_item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM gacha_item_masters WHERE gacha_id=40 ORDER BY id ASC\G

# Query 12: 315.75 QPS, 0.21x concurrency, ID 0x2372FB123B18A108CFBB5352F61B370B at byte 158874108
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5   18945
# Exec time      1     12s    50us    94ms   658us     3ms     2ms   138us
# Lock time      6   147ms       0    24ms     7us     1us   221us     1us
# Rows sent      2  18.50k       0       1    1.00    0.99    0.01    0.99
# Rows examine   0  18.50k       0       1    1.00    0.99    0.01    0.99
# Query size     0 718.62k      33      39   38.84   38.53    0.65   38.53
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ################################
# 100us  ################################################################
#   1ms  #############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'users'\G
#    SHOW CREATE TABLE `isucon`.`users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM users WHERE id=1328244000\G

# Query 13: 349.93 QPS, 0.20x concurrency, ID 0xAB2AB35C6EFA17C04018A132A84A16C9 at byte 175756792
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   20996
# Exec time      1     12s    50us    67ms   558us     2ms     2ms   119us
# Lock time      6   137ms       0    35ms     6us     1us   247us     1us
# Rows sent      0     585       0       1    0.03       0    0.16       0
# Rows examine   0     585       0       1    0.03       0    0.16       0
# Query size     0 980.99k      45      48   47.84   46.83    0.24   46.83
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ############################################
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_bans'\G
#    SHOW CREATE TABLE `isucon`.`user_bans`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_bans WHERE user_id=8071960445\G

# Query 14: 183.97 QPS, 0.19x concurrency, ID 0x584D7D428BA6602840353479CEB359A1 at byte 168763314
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   11038
# Exec time      1     12s   102us    97ms     1ms     4ms     3ms   224us
# Lock time      2    62ms       0     6ms     5us     1us    87us     1us
# Rows sent      1  10.78k       1       1       1       1       0       1
# Rows examine   0  10.78k       1       2    1.00    0.99    0.02    0.99
# Query size     0 832.66k      74      78   77.25   76.28    1.20   76.28
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ##############
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_devices'\G
#    SHOW CREATE TABLE `isucon`.`user_devices`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_devices WHERE user_id=5815908581 AND platform_id='7253441'\G

# Query 15: 0 QPS, 0x concurrency, ID 0x79A889ED30BFA8BF517F86F6D70065B6 at byte 76650793
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: all events occurred at 2023-11-21T19:09:49
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0       1
# Exec time      1     11s     11s     11s     11s     11s       0     11s
# Lock time      0     2us     2us     2us     2us     2us       0     2us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0     146     146     146     146     146       0     146
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms
#    1s
#  10s+  ################################################################
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
LOAD DATA INFILE '/var/lib/mysql-files/5_user_presents_not_receive_data.tsv' REPLACE INTO TABLE user_presents FIELDS ESCAPED BY '|' IGNORE 1 LINES\G

# Query 16: 4.18 QPS, 1.00x concurrency, ID 0x2096778F723F6666B5D7DDC9D01010C7 at byte 36322413
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.05
# Time range: 2023-11-21T19:09:21 to 2023-11-21T19:09:32
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0      46
# Exec time      1     11s   145ms   494ms   239ms   455ms   111ms   171ms
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size    40  45.18M 970.86k 1006.59k 1005.76k 961.27k       0 961.27k
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms  ################################################################
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_cards'\G
#    SHOW CREATE TABLE `isucon`.`user_cards`\G
INSERT INTO `user_cards` VALUES (76191431933,6073303372,3,76,38,7800,1569290794,1569290794,NULL) /*... omitted ...*/\G

# Query 17: 55.62 QPS, 0.13x concurrency, ID 0x1049606E13674A053E0CC69500F839DC at byte 173638711
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3337
# Exec time      1      8s   136us   128ms     2ms    11ms     6ms   403us
# Lock time      0    13ms       0     2ms     3us     1us    48us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0   3.26k       1       1       1       1       0       1
# Query size     0 338.91k     104     104     104     104       0     104
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #########################
#  10ms  #####
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_one_time_tokens'\G
#    SHOW CREATE TABLE `isucon`.`user_one_time_tokens`\G
UPDATE user_one_time_tokens SET deleted_at=1661713845 WHERE token='de26972d-3552-45a5-bed2-1e5c41b21060'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  deleted_at=1661713845 from user_one_time_tokens where  token='de26972d-3552-45a5-bed2-1e5c41b21060'\G

# Query 18: 56.10 QPS, 0.12x concurrency, ID 0xAFB4A7475DFDCF1D0D23CC5EC1952C3A at byte 149047892
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3366
# Exec time      1      7s    95us   107ms     2ms     9ms     6ms   403us
# Lock time      1    26ms       0     6ms     7us     1us   143us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0 692.15k     207     211  210.57  202.40       0  202.40
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  #######################
#  10ms  ####
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_one_time_tokens'\G
#    SHOW CREATE TABLE `isucon`.`user_one_time_tokens`\G
INSERT INTO user_one_time_tokens(id, user_id, token, token_type, created_at, updated_at, expired_at) VALUES (1929998811, 1844757163, '693425b2-5ba0-4907-8ce1-019503f82c46', 1, 1661713830, 1661713830, 1661714430)\G

# Query 19: 219.27 QPS, 0.11x concurrency, ID 0x0B3509236B570F5C5FE423B079765901 at byte 149023113
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   13156
# Exec time      1      7s    52us    65ms   513us     2ms     2ms   125us
# Lock time      3    78ms       0    12ms     5us     1us   154us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     1   2.14M     164     176  170.20  166.51    0.86  166.51
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ########################
# 100us  ################################################################
#   1ms  ########
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_cards'\G
#    SHOW CREATE TABLE `isucon`.`user_cards`\G
INSERT INTO user_cards(id, user_id, card_id, amount_per_sec, level, total_exp, created_at, updated_at) VALUES (1966609351, 1020632084, 2, 1, 1, 0, 1661713831, 1661713831)\G

# Query 20: 42.20 QPS, 0.11x concurrency, ID 0x9A8F7951E72A024B1DB911A4707B09DB at byte 144509030
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.03
# Time range: 2023-11-21T19:09:50 to 2023-11-21T19:10:50
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    2532
# Exec time      0      7s    91us   116ms     3ms    12ms     8ms   273us
# Lock time      0     4ms       0   251us     1us     1us     8us     1us
# Rows sent      2  15.69k       1      12    6.35    9.83    1.91    5.75
# Rows examine   0  15.69k       1      12    6.35    9.83    1.91    5.75
# Query size     0 320.12k      79     251  129.46  174.84   30.57  130.47
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ################
#  10ms  #####
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'item_masters'\G
#    SHOW CREATE TABLE `isucon`.`item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM item_masters WHERE id IN (21, 21, 21, 17, 17, 17, 18, 17, 25, 18, 17, 17, 17, 18, 24, 21, 21, 18) AND item_type IN (3, 4)\G
