
# 13.4s user time, 80ms system time, 57.56M rss, 390.01G vsz
# Current date: Thu Nov 23 19:46:56 2023
# Hostname: YusukenoMac-mini.local
# Files: slowquery/log/mysql-slow.log
# Overall: 315.75k total, 178 unique, 3.22k QPS, 4.76x concurrency _______
# Time range: 2023-11-23T10:44:40 to 2023-11-23T10:46:18
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time           467s     1us     16s     1ms     5ms    29ms   194us
# Lock time             2s       0   102ms     7us     1us   342us     1us
# Rows sent        795.31k       0    1012    2.58   26.08    7.18    0.99
# Rows examine       1.87M       0    1012    6.20   44.60   14.12    0.99
# Query size       113.75M       6 1008.95k  377.74  400.73  14.64k   69.19

# Profile
# Rank Query ID                            Response time Calls  R/Call  V/
# ==== =================================== ============= ====== ======= ==
#    1 0x6E790EE92EFF4755B6E0FA83F9CA8363  82.9764 17.8%   3978  0.0209  0.05 UPDATE user_presents
#    2 0x03FFA53B9AEA23779E51FE7DD3DC165E  36.4583  7.8%   5707  0.0064  0.02 INSERT user_presents
#    3 0x611363ACBD1690538F137757E45B738C  26.7040  5.7%   3993  0.0067  0.01 SELECT user_presents
#    4 0xE89B4FB5E77ED142BEAF8C3B369FA2FE  23.8803  5.1%   3978  0.0060  0.02 SELECT user_presents
#    5 0xFFFCA4D67EA0A788813031B8BBC3B329  21.1370  4.5%  11903  0.0018  0.02 COMMIT
#    6 0x8CA5C26DA1F53D285B58FE47352DA00A  21.0436  4.5%  21939  0.0010  0.01 SELECT user_sessions
#    7 0x79A889ED30BFA8BF517F86F6D70065B6  16.1476  3.5%      1 16.1476  0.00 LOAD DATA user_presents
#    8 0x07D5CE9B533D56A3B70C17C590E82A7F  15.2027  3.3%  25677  0.0006  0.01 SELECT version_masters
#    9 0xBC551EACF5A3BE27E3F2CC3C5133F3D5  14.4820  3.1%  12067  0.0012  0.01 SELECT gacha_item_masters
#   10 0x2372FB123B18A108CFBB5352F61B370B  13.5646  2.9%  22238  0.0006  0.01 SELECT users
#   11 0xAB2AB35C6EFA17C04018A132A84A16C9  13.2045  2.8%  24688  0.0005  0.01 SELECT user_bans
#   12 0x584D7D428BA6602840353479CEB359A1  11.7568  2.5%  13064  0.0009  0.01 SELECT user_devices
#   13 0x0B3509236B570F5C5FE423B079765901  11.1368  2.4%  16194  0.0007  0.01 INSERT user_cards
#   14 0x975F0A7CC9BCA46BBC7DAD888BA0794F  11.0990  2.4%  15074  0.0007  0.01 SELECT item_masters
#   15 0x2096778F723F6666B5D7DDC9D01010C7  10.8271  2.3%     46  0.2354  0.06 INSERT user_cards
#   16 0x1049606E13674A053E0CC69500F839DC   8.4144  1.8%   3913  0.0022  0.01 UPDATE user_one_time_tokens
#   17 0xD858CC1645CE084FE3844E34483B662E   7.9708  1.7%  10245  0.0008  0.01 UPDATE users
#   18 0x6DBD0D1D3EC3BC206B6AD54E826B3141   7.7268  1.7%   3020  0.0026  0.01 INSERT UPDATE user_items
#   19 0x41CEDDDAFB6289B60E5F30D0462408DB   7.5329  1.6%   2699  0.0028  0.01 INSERT user_present_all_received_history
#   20 0xAFB4A7475DFDCF1D0D23CC5EC1952C3A   7.3848  1.6%   3942  0.0019  0.01 INSERT user_one_time_tokens
# MISC 0xMISC                              97.8615 21.0% 111388  0.0009   0.0 <158 ITEMS>

# Query 1: 66.30 QPS, 1.38x concurrency, ID 0x6E790EE92EFF4755B6E0FA83F9CA8363 at byte 181261800
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.05
# Time range: 2023-11-23T10:45:18 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3978
# Exec time     17     83s   268us   311ms    21ms    87ms    32ms     7ms
# Lock time      0    15ms       0     3ms     3us     1us    55us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   5 102.15k       1      65   26.29   46.83   11.89   27.38
# Query size     1   1.52M      93     905  401.69  652.75  148.17  400.73
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ##############
#   1ms  ################################################################
#  10ms  ######################################################
# 100ms  #####
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
UPDATE user_presents SET deleted_at=1661683576, updated_at=1661683576 WHERE id IN (460322706, 1042212653, 1088704615, 1131629199, 1184044008, 1409376379, 1706341939, 1800712354, 1816033950, 1827495106, 1839756500, 1869491210, 1943785008, 2046070724, 2616867357, 2855187752, 3012891977, 3018676655, 3113660807, 3186753405, 3203266630, 3325559304, 3411294558, 3815123211, 3843301648, 7210712027, 19389040642, 22903120785, 32504740896, 36601186707, 46028685396, 49034724134, 51715195958, 54870693280, 59376047589, 61737286129, 63084550787, 69322208189, 72850504427, 73035072528, 77613384311, 85877867108, 86241405840, 87178408453, 91502616474)\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  deleted_at=1661683576, updated_at=1661683576 from user_presents where  id IN (460322706, 1042212653, 1088704615, 1131629199, 1184044008, 1409376379, 1706341939, 1800712354, 1816033950, 1827495106, 1839756500, 1869491210, 1943785008, 2046070724, 2616867357, 2855187752, 3012891977, 3018676655, 3113660807, 3186753405, 3203266630, 3325559304, 3411294558, 3815123211, 3843301648, 7210712027, 19389040642, 22903120785, 32504740896, 36601186707, 46028685396, 49034724134, 51715195958, 54870693280, 59376047589, 61737286129, 63084550787, 69322208189, 72850504427, 73035072528, 77613384311, 85877867108, 86241405840, 87178408453, 91502616474)\G

# Query 2: 93.56 QPS, 0.60x concurrency, ID 0x03FFA53B9AEA23779E51FE7DD3DC165E at byte 158836790
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    5707
# Exec time      7     36s    88us   169ms     6ms    28ms    12ms     2ms
# Lock time      0    17ms       0     2ms     2us     1us    47us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     7   8.28M     234   3.32k   1.49k   3.19k  918.40   1.26k
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  #####################################
#   1ms  ################################################################
#  10ms  ####################
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
INSERT INTO user_presents(id, user_id, sent_at, item_type, item_id, amount, present_message, created_at, updated_at) VALUES (4076659977, 679101039, 1661683564, 1, 1, 3000, 'リリース記念プレゼントです！', 1661683564, 1661683564),(2248608811, 679101039, 1661683564, 1, 1, 1000, '１ヶ月突破プレゼントです！', 1661683564, 1661683564),(3681936992, 679101039, 1661683564, 1, 1, 1000, '２ヶ月突破プレゼントです！', 1661683564, 1661683564),(3651832510, 679101039, 1661683564, 1, 1, 2000, '３ヶ月突破プレゼントです！', 1661683564, 1661683564),(586860286, 679101039, 1661683564, 1, 1, 2000, '４ヶ月突破プレゼントです！', 1661683564, 1661683564),(3715130258, 679101039, 1661683564, 1, 1, 2000, '５ヶ月突破プレゼントです！', 1661683564, 1661683564),(654385732, 679101039, 1661683564, 1, 1, 3000, 'ハーフアニバーサリープレゼントです！', 1661683564, 1661683564),(36423125, 679101039, 1661683564, 1, 1, 2000, '７ヶ月突破プレゼントです！', 1661683564, 1661683564),(236567708, 679101039, 1661683564, 1, 1, 2000, '８ヶ月突破プレゼントです！', 1661683564, 1661683564),(4179819089, 679101039, 1661683564, 1, 1, 2000, '９ヶ月突破プレゼントです！', 1661683564, 1661683564),(911780031, 679101039, 1661683564, 1, 1, 2000, '１０ヶ月突破プレゼントです！', 1661683564, 1661683564),(2888951009, 679101039, 1661683564, 1, 1, 2000, '１１ヶ月突破プレゼントです！', 1661683564, 1661683564),(3711849944, 679101039, 1661683564, 1, 1, 3000, '１周年突破プレゼントです！', 1661683564, 1661683564),(445148041, 679101039, 1661683564, 1, 1, 6000, '周年記念プレゼントです！', 1661683564, 1661683564),(788088761, 679101039, 1661683564, 1, 1, 2000, '１３ヶ月突破プレゼントです！', 1661683564, 1661683564),(33716837, 679101039, 1661683564, 1, 1, 2000, '１４ヶ月突破プレゼントです！', 1661683564, 1661683564),(1370493754, 679101039, 1661683564, 1, 1, 2000, '１５ヶ月突破プレゼントです１', 1661683564, 1661683564),(3752997769, 679101039, 1661683564, 1, 1, 2000, '１６ヶ月突破プレゼントです！', 1661683564, 1661683564),(2221263261, 679101039, 1661683564, 1, 1, 2000, '１７ヶ月突破プレゼントです！', 1661683564, 1661683564),(2832577369, 679101039, 1661683564, 1, 1, 2000, '１８ヶ月突破プレゼントです！', 1661683564, 1661683564),(2199285370, 679101039, 1661683564, 1, 1, 2000, '１９ヶ月突破プレゼントです！', 1661683564, 1661683564),(3391607413, 679101039, 1661683564, 1, 1, 2000, '２０ヶ月突破プレゼントです！', 1661683564, 1661683564),(3817465925, 679101039, 1661683564, 1, 1, 2000, '２１ヶ月プレゼントです！', 1661683564, 1661683564),(4213458531, 679101039, 1661683564, 1, 1, 2000, '２２ヶ月プレゼントです！', 1661683564, 1661683564),(2031244890, 679101039, 1661683564, 1, 1, 2000, '２３ヶ月プレゼントです！', 1661683564, 1661683564),(1704577265, 679101039, 1661683564, 1, 1, 6000, '２周年記念プレゼントです！', 1661683564, 1661683564),(1948821725, 679101039, 1661683564, 1, 1, 6000, '２.５周年プレゼントです！', 1661683564, 1661683564),(4089477525, 679101039, 1661683564, 1, 1, 6000, 'CM放映記念プレゼントです！', 1661683564, 1661683564)\G

# Query 3: 65.46 QPS, 0.44x concurrency, ID 0x611363ACBD1690538F137757E45B738C at byte 156938407
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3993
# Exec time      5     27s   128us   128ms     7ms    26ms     9ms     3ms
# Lock time      0    12ms       0     1ms     3us     1us    28us     1us
# Rows sent     12 102.39k       0      65   26.26   46.83   11.90   27.38
# Rows examine   5 102.39k       0      65   26.26   46.83   11.90   27.38
# Query size     0 502.32k     126     129  128.82  124.25       0  124.25
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  #############################
#   1ms  ################################################################
#  10ms  ########################
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_presents 
	WHERE user_id = 6646474436 AND deleted_at IS NULL
	ORDER BY created_at DESC, id
	LIMIT 100 OFFSET 0\G

# Query 4: 65.21 QPS, 0.39x concurrency, ID 0xE89B4FB5E77ED142BEAF8C3B369FA2FE at byte 142409616
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3978
# Exec time      5     24s   129us   135ms     6ms    30ms    12ms     1ms
# Lock time      0    18ms       0     3ms     4us     1us    64us     1us
# Rows sent     12 102.15k       1      65   26.29   46.83   11.89   27.38
# Rows examine   5 102.15k       1      65   26.29   46.83   11.89   27.38
# Query size     1   1.45M      74     886  382.69  621.67  148.45  381.65
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #############################################
#  10ms  #######################
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_presents WHERE id IN (66627193, 137113697, 532497933, 686020431, 1075199811, 1138334676, 1397267028, 1408231031, 2481614341, 2543203455, 2563725549, 3327139428, 3572151257, 3825387602, 4178399664, 601833954, 693232792, 1166568462, 1235473800, 1729481440, 2698154463, 2841500821, 2871092756, 3581382130, 4131552901, 62245208591, 38336545424, 49411380040, 54344797353, 55859458042, 7553571449, 67593947486, 82950392964, 84580977692, 2450070294, 38750372666, 24329450239, 30704996404, 19022480614, 91831352002, 55773449753, 8241137523, 39269745055, 80771306300, 610322908, 59962884395, 97133733251, 97964707592) AND deleted_at IS NULL\G

# Query 5: 195.13 QPS, 0.35x concurrency, ID 0xFFFCA4D67EA0A788813031B8BBC3B329 at byte 169763204
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.02
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   11903
# Exec time      4     21s    37us   117ms     2ms     8ms     5ms   287us
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0  69.74k       6       6       6       6       0       6
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #######################################
# 100us  ################################################################
#   1ms  ############################
#  10ms  #####
# 100ms  #
#    1s
#  10s+
COMMIT\G

# Query 6: 359.66 QPS, 0.34x concurrency, ID 0x8CA5C26DA1F53D285B58FE47352DA00A at byte 136225344
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   21939
# Exec time      4     21s    91us    92ms   959us     4ms     3ms   214us
# Lock time      8   206ms       0    27ms     9us     1us   304us     1us
# Rows sent      2  21.42k       0       1    1.00    0.99    0.01    0.99
# Rows examine   1  21.42k       0       1    1.00    0.99    0.01    0.99
# Query size     1   2.22M      81     106  106.00  102.22    0.15  102.22
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_sessions'\G
#    SHOW CREATE TABLE `isucon`.`user_sessions`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_sessions WHERE session_id='e0009398-d2fe-4984-814c-cd6820eb31d9' AND deleted_at IS NULL\G

# Query 7: 0 QPS, 0x concurrency, ID 0x79A889ED30BFA8BF517F86F6D70065B6 at byte 76650857
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: all events occurred at 2023-11-23T10:45:17
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0       1
# Exec time      3     16s     16s     16s     16s     16s       0     16s
# Lock time      0     2us     2us     2us     2us     2us       0     2us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0     146     146     146     146     146       0     146
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms
#    1s
#  10s+  ################################################################
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_presents'\G
#    SHOW CREATE TABLE `isucon`.`user_presents`\G
LOAD DATA INFILE '/var/lib/mysql-files/5_user_presents_not_receive_data.tsv' REPLACE INTO TABLE user_presents FIELDS ESCAPED BY '|' IGNORE 1 LINES\G

# Query 8: 420.93 QPS, 0.25x concurrency, ID 0x07D5CE9B533D56A3B70C17C590E82A7F at byte 89177253
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          8   25677
# Exec time      3     15s    48us   136ms   592us     2ms     2ms   138us
# Lock time      7   182ms       0    15ms     7us     1us   171us     1us
# Rows sent      3  25.08k       1       1       1       1       0       1
# Rows examine   2  42.97k       1       2    1.71    1.96    0.44    1.96
# Query size     0   1.08M      44      44      44      44       0      44
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ############################
# 100us  ################################################################
#   1ms  ##########
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'version_masters'\G
#    SHOW CREATE TABLE `isucon`.`version_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM version_masters WHERE status=1\G

# Query 9: 201.12 QPS, 0.24x concurrency, ID 0xBC551EACF5A3BE27E3F2CC3C5133F3D5 at byte 172166702
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:18 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   12067
# Exec time      3     14s   114us    73ms     1ms     5ms     3ms   332us
# Lock time      3    86ms       0    23ms     7us     1us   215us     1us
# Rows sent     42 335.84k      27      29   28.50   28.75       1   28.75
# Rows examine  35 671.68k      54      58   57.00   56.92       2   56.92
# Query size     0 783.62k      66      68   66.50   65.89       0   65.89
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ################
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'gacha_item_masters'\G
#    SHOW CREATE TABLE `isucon`.`gacha_item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM gacha_item_masters WHERE gacha_id=31 ORDER BY id ASC\G

# Query 10: 364.56 QPS, 0.22x concurrency, ID 0x2372FB123B18A108CFBB5352F61B370B at byte 144221037
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          7   22238
# Exec time      2     14s    49us    50ms   609us     2ms     2ms   138us
# Lock time      5   116ms       0     9ms     5us     1us   106us     1us
# Rows sent      2  21.72k       0       1    1.00    0.99    0.01    0.99
# Rows examine   1  21.72k       0       1    1.00    0.99    0.01    0.99
# Query size     0 843.30k      33      39   38.83   38.53    0.67   38.53
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ###################################
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'users'\G
#    SHOW CREATE TABLE `isucon`.`users`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM users WHERE id=9253489146\G

# Query 11: 404.72 QPS, 0.22x concurrency, ID 0xAB2AB35C6EFA17C04018A132A84A16C9 at byte 175014523
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          7   24688
# Exec time      2     13s    47us   111ms   534us     2ms     2ms   119us
# Lock time      7   169ms       0    15ms     6us     1us   166us     1us
# Rows sent      0     600       0       1    0.02       0    0.15       0
# Rows examine   0     600       0       1    0.02       0    0.15       0
# Query size     0   1.13M      45      48   47.83   46.83    0.27   46.83
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##############################################
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_bans'\G
#    SHOW CREATE TABLE `isucon`.`user_bans`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_bans WHERE user_id=4118838345\G

# Query 12: 214.16 QPS, 0.19x concurrency, ID 0x584D7D428BA6602840353479CEB359A1 at byte 162532405
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          4   13064
# Exec time      2     12s    98us    50ms   899us     4ms     2ms   224us
# Lock time      2    65ms       0     6ms     4us     1us    97us     1us
# Rows sent      1  12.76k       1       1       1       1       0       1
# Rows examine   0  12.77k       1       2    1.00    0.99    0.03    0.99
# Query size     0 985.58k      74      78   77.25   76.28    1.22   76.28
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_devices'\G
#    SHOW CREATE TABLE `isucon`.`user_devices`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user_devices WHERE user_id=2760810835 AND platform_id='28741459'\G

# Query 13: 265.48 QPS, 0.18x concurrency, ID 0x0B3509236B570F5C5FE423B079765901 at byte 122517187
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          5   16194
# Exec time      2     11s    48us    85ms   687us     3ms     2ms   138us
# Lock time      6   141ms       0    36ms     8us     1us   316us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     2   2.63M     165     176  170.22  166.51    0.89  166.51
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ###########################
# 100us  ################################################################
#   1ms  #############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_cards'\G
#    SHOW CREATE TABLE `isucon`.`user_cards`\G
INSERT INTO user_cards(id, user_id, card_id, amount_per_sec, level, total_exp, created_at, updated_at) VALUES (3452488943, 3637121392, 13, 5000, 1, 0, 1661683545, 1661683545)\G

# Query 14: 247.11 QPS, 0.18x concurrency, ID 0x975F0A7CC9BCA46BBC7DAD888BA0794F at byte 156969452
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          4   15074
# Exec time      2     11s    48us   126ms   736us     3ms     3ms   159us
# Lock time      5   117ms       0    13ms     7us     1us   184us     1us
# Rows sent      1  14.72k       1       1       1       1       0       1
# Rows examine   0  14.72k       1       1       1       1       0       1
# Query size     0 783.32k      53      54   53.21   51.63       0   51.63
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##########################
# 100us  ################################################################
#   1ms  #############
#  10ms  #
# 100ms  #
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'item_masters'\G
#    SHOW CREATE TABLE `isucon`.`item_masters`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM item_masters WHERE id=4 AND item_type=2\G

# Query 15: 4.60 QPS, 1.08x concurrency, ID 0x2096778F723F6666B5D7DDC9D01010C7 at byte 41477056
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.06
# Time range: 2023-11-23T10:44:44 to 2023-11-23T10:44:54
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0      46
# Exec time      2     11s   139ms   544ms   235ms   455ms   116ms   171ms
# Lock time      0       0       0       0       0       0       0       0
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size    39  45.18M 970.86k 1006.59k 1005.76k 961.27k       0 961.27k
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms  ################################################################
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_cards'\G
#    SHOW CREATE TABLE `isucon`.`user_cards`\G
INSERT INTO `user_cards` VALUES (87050245393,8653328264,4,190,38,7478,1566586236,1566586236,NULL) /*... omitted ...*/\G

# Query 16: 64.15 QPS, 0.14x concurrency, ID 0x1049606E13674A053E0CC69500F839DC at byte 165871162
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3913
# Exec time      1      8s   143us    95ms     2ms    10ms     5ms   515us
# Lock time      1    24ms       0     3ms     6us     1us    84us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0   3.82k       1       1       1       1       0       1
# Query size     0 397.41k     104     104     104     104       0     104
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  #############################
#  10ms  ####
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_one_time_tokens'\G
#    SHOW CREATE TABLE `isucon`.`user_one_time_tokens`\G
UPDATE user_one_time_tokens SET deleted_at=1661683568 WHERE token='77536acc-59b5-4666-90a9-5df2701133fb'\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  deleted_at=1661683568 from user_one_time_tokens where  token='77536acc-59b5-4666-90a9-5df2701133fb'\G

# Query 17: 167.95 QPS, 0.13x concurrency, ID 0xD858CC1645CE084FE3844E34483B662E at byte 132585283
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          3   10245
# Exec time      1      8s    58us    46ms   778us     3ms     2ms   144us
# Lock time      2    53ms       0     8ms     5us     1us   130us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0  10.00k       1       1       1       1       0       1
# Query size     0 522.04k      47      57   52.18   54.21    2.90   49.17
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  ####################
# 100us  ################################################################
#   1ms  #############
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'users'\G
#    SHOW CREATE TABLE `isucon`.`users`\G
UPDATE users SET isu_coin=79500 WHERE id=4292513222\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select  isu_coin=79500 from users where  id=4292513222\G

# Query 18: 50.33 QPS, 0.13x concurrency, ID 0x6DBD0D1D3EC3BC206B6AD54E826B3141 at byte 137904168
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:18 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    3020
# Exec time      1      8s   139us    65ms     3ms    11ms     5ms   690us
# Lock time      0     8ms       0     2ms     2us     1us    48us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     3   3.63M     352   2.88k   1.23k   1.86k  481.07   1.20k
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us  ################################################################
#   1ms  ####################################
#  10ms  ######
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_items'\G
#    SHOW CREATE TABLE `isucon`.`user_items`\G
INSERT INTO user_items (id, user_id, item_id, item_type, amount, created_at, updated_at) VALUES (65422593745, 1207263240, 27, 4, 4, 1564671859, 1661683553), (65102624055, 1207263240, 17, 3, 96, 1564671859, 1661683553), (34029056012, 1207263240, 23, 4, 12, 1564671859, 1661683553), (51711797128, 1207263240, 21, 4, 48, 1564671859, 1661683553), (22016295963, 1207263240, 18, 3, 31, 1564671859, 1661683553), (51711797128, 1207263240, 21, 4, 48, 1564671859, 1661683553), (51711797128, 1207263240, 21, 4, 48, 1564671859, 1661683553), (45359271060, 1207263240, 19, 3, 30, 1564671859, 1661683553), (65102624055, 1207263240, 17, 3, 96, 1564671859, 1661683553), (45359271060, 1207263240, 19, 3, 30, 1564671859, 1661683553), (51711797128, 1207263240, 21, 4, 48, 1564671859, 1661683553), (44963106962, 1207263240, 20, 3, 9, 1564671859, 1661683553), (12129236367, 1207263240, 28, 4, 4, 1564671859, 1661683553), (22016295963, 1207263240, 18, 3, 31, 1564671859, 1661683553), (34029056012, 1207263240, 23, 4, 12, 1564671859, 1661683553), (65102624055, 1207263240, 17, 3, 96, 1564671859, 1661683553), (51711797128, 1207263240, 21, 4, 48, 1564671859, 1661683553), (22016295963, 1207263240, 18, 3, 31, 1564671859, 1661683553), (65102624055, 1207263240, 17, 3, 96, 1564671859, 1661683553), (65102624055, 1207263240, 17, 3, 96, 1564671859, 1661683553), (22016295963, 1207263240, 18, 3, 31, 1564671859, 1661683553), (22016295963, 1207263240, 18, 3, 31, 1564671859, 1661683553), (65102624055, 1207263240, 17, 3, 96, 1564671859, 1661683553), (51711797128, 1207263240, 21, 4, 48, 1564671859, 1661683553), (45359271060, 1207263240, 19, 3, 30, 1564671859, 1661683553), (45359271060, 1207263240, 19, 3, 30, 1564671859, 1661683553), (84267648498, 1207263240, 26, 4, 8, 1564671859, 1661683553), (82144222889, 1207263240, 25, 4, 9, 1564671859, 1661683553) ON DUPLICATE KEY UPDATE amount = VALUES(amount), updated_at = VALUES(updated_at)\G

# Query 19: 44.25 QPS, 0.12x concurrency, ID 0x41CEDDDAFB6289B60E5F30D0462408DB at byte 173445586
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    2699
# Exec time      1      8s    61us    77ms     3ms    14ms     6ms   541us
# Lock time      0    10ms       0     3ms     3us     1us    69us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     2   2.65M     179   1.88k   1.00k   1.86k  725.88   1.04k
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #############
# 100us  ################################################################
#   1ms  ###################################
#  10ms  #########
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_present_all_received_history'\G
#    SHOW CREATE TABLE `isucon`.`user_present_all_received_history`\G
INSERT INTO user_present_all_received_history(id, user_id, present_all_id, received_at, created_at, updated_at) VALUES (2057533688, 761966808, 1, 1661683572, 1661683572, 1661683572),(2190036737, 761966808, 3, 1661683572, 1661683572, 1661683572),(3385925141, 761966808, 4, 1661683572, 1661683572, 1661683572),(3613693606, 761966808, 5, 1661683572, 1661683572, 1661683572),(2199430650, 761966808, 6, 1661683572, 1661683572, 1661683572),(3920895630, 761966808, 7, 1661683572, 1661683572, 1661683572),(1320530713, 761966808, 8, 1661683572, 1661683572, 1661683572),(3376930566, 761966808, 9, 1661683572, 1661683572, 1661683572),(1221646914, 761966808, 10, 1661683572, 1661683572, 1661683572),(391001676, 761966808, 11, 1661683572, 1661683572, 1661683572),(4076525932, 761966808, 12, 1661683572, 1661683572, 1661683572),(1671616243, 761966808, 13, 1661683572, 1661683572, 1661683572),(2630400955, 761966808, 14, 1661683572, 1661683572, 1661683572),(1002042709, 761966808, 15, 1661683572, 1661683572, 1661683572),(2583214167, 761966808, 16, 1661683572, 1661683572, 1661683572),(3905786339, 761966808, 17, 1661683572, 1661683572, 1661683572),(3015200072, 761966808, 18, 1661683572, 1661683572, 1661683572),(3750910410, 761966808, 19, 1661683572, 1661683572, 1661683572),(1163311131, 761966808, 20, 1661683572, 1661683572, 1661683572),(934846719, 761966808, 21, 1661683572, 1661683572, 1661683572),(1731399351, 761966808, 22, 1661683572, 1661683572, 1661683572),(841784933, 761966808, 23, 1661683572, 1661683572, 1661683572),(4205741871, 761966808, 24, 1661683572, 1661683572, 1661683572),(1800413787, 761966808, 25, 1661683572, 1661683572, 1661683572),(3473431499, 761966808, 26, 1661683572, 1661683572, 1661683572),(374240921, 761966808, 27, 1661683572, 1661683572, 1661683572),(1646161900, 761966808, 28, 1661683572, 1661683572, 1661683572),(537636177, 761966808, 29, 1661683572, 1661683572, 1661683572)\G

# Query 20: 64.62 QPS, 0.12x concurrency, ID 0xAFB4A7475DFDCF1D0D23CC5EC1952C3A at byte 149709112
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.01
# Time range: 2023-11-23T10:45:17 to 2023-11-23T10:46:18
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          1    3942
# Exec time      1      7s    96us    74ms     2ms     8ms     5ms   445us
# Lock time      1    26ms       0     6ms     6us     1us   130us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     0 810.57k     207     211  210.56  202.40       0  202.40
# String:
# Databases    isucon
# Hosts        localhost
# Users        isucon
# Query_time distribution
#   1us
#  10us  #
# 100us  ################################################################
#   1ms  ########################
#  10ms  ###
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon` LIKE 'user_one_time_tokens'\G
#    SHOW CREATE TABLE `isucon`.`user_one_time_tokens`\G
INSERT INTO user_one_time_tokens(id, user_id, token, token_type, created_at, updated_at, expired_at) VALUES (2560735912, 1373491752, 'b4ff8548-2ac2-48e3-af12-98d1cd5f17f7', 1, 1661683559, 1661683559, 1661684159)\G
